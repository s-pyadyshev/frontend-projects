(this["webpackJsonpecwid-front-test"]=this["webpackJsonpecwid-front-test"]||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports=n(20)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(7),c=n.n(i),o=(n(13),n(2)),l=function(e,t){return e.includes(function(e){return e.name.split(".").pop().toLowerCase()}(t))},u=function(e,t){return e.includes(function(e){return e.split(".").pop().toLowerCase()}(t))};var s=["jpg","jpeg","png"],d=["json"],f=(n(14),function(e){var t=e.dispatch,n=Object(a.useState)(""),i=Object(o.a)(n,2),c=i[0],l=i[1],f=Object(a.useState)(""),p=Object(o.a)(f,2),h=p[0],m=p[1],E=function(e){var n=new Image;n.src=e;n.onload=function(){var e=n.src,a=n.width,r=n.height;t({type:"ADD_FILE_TO_LIST",file:{url:e,width:a,height:r,ratio:a/r}}),m("")}};return r.a.createElement("form",{className:"form"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",type:"text",onChange:function(e){l(e.target.value)},value:c}),r.a.createElement("div",{className:"control__error color-error"},h)),r.a.createElement("button",{className:"button",onClick:function(e){e.preventDefault(),u(d,c)?(fetch(c).then((function(e){return e.json()})).then((function(e){t({type:"ADD_JSON_TO_LIST",files:e.galleryImages})})).then((function(){return m("")})),l("")):u(s,c)?(!function(e,t){if(t)return E(e);(void 0).onloadend=function(){return E(e.target.result)}}(c,!0),l("")):m("Invalid url or file type is not allowed")}},"Upload file (JSON or Image)"))}),p=n(3),h=n(1),m=(n(15),function(){return r.a.createElement("div",{className:"lds-spinner"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null))}),E=(n(16),function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],i=Object(a.useRef)(),c=function(){r(!0)};return Object(a.useEffect)((function(){i.current&&i.current.complete&&c()})),[i,n,c]}),O=function(e){var t=e.url,n=e.width,a=e.height,i=e.imageWidth,c=E(),l=Object(o.a)(c,3),u=l[0],s=l[1],d=l[2];return r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t,width:n,height:a,alt:".some alt text",ref:u,onLoad:d}),s?null:r.a.createElement("div",{className:"image-loader",style:{width:i,height:a}},r.a.createElement(m,null)))};n(17);var v=function(){var e=Object(a.useRef)(null),t=Object(a.useState)({width:0,height:0}),n=Object(o.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){var t=function(e,t,n){var a;return function(){var r=this,i=arguments,c=function(){a=null,n||e.apply(r,i)},o=n&&!a;clearTimeout(a),a=setTimeout(c,t),o&&e.apply(r,i)}}((function(){i({width:e.current.offsetWidth,height:e.current.offsetHeight})}),250);return window.addEventListener("resize",t),t(),function(){return window.removeEventListener("resize",t)}}),[]),[r,e]},g=function(e){var t=e.storeImages,n=e.dispatch,i=Object(a.useState)(t),c=Object(o.a)(i,2),l=c[0],u=c[1],s=v(0),d=Object(o.a)(s,2),f=d[0],m=d[1],E=f.width,g=200;f.width<E?(E=f.width,g=100):f.width<640&&(g=300);Object(a.useEffect)((function(){var e=[],n=0,a=[];t.forEach((function(t,r,i){var c=t.width,o=t.height,l=t.ratio,u=t.url;if(a.push({width:c,height:o,ratio:l,url:u}),(n+=g*l)>E){var s=a.map((function(e){var t=g-g*((n-E)/(n/100)/100);return Object(h.a)(Object(h.a)({},e),{},{height:t,width:t*e.ratio})}));e=[].concat(Object(p.a)(e),Object(p.a)(s)),a=[],n=0}else if(r===i.length-1&&n<E){var d=a.map((function(e){return Object(h.a)(Object(h.a)({},e),{},{height:g,width:g*e.ratio})}));e=[].concat(Object(p.a)(e),Object(p.a)(d)),a=[],n=0}})),u(e)}),[t,f]);return r.a.createElement("div",{className:"gallery",ref:m},r.a.createElement("ul",{className:"gallery__list"},l.map((function(e,t){return r.a.createElement("li",{key:t,className:"gallery__item",style:{width:e.width,height:e.height}},r.a.createElement(O,{url:e.url}),r.a.createElement("button",{className:"gallery__item-remove",onClick:function(){n({type:"REMOVE_IMAGE",index:t})}},"Remove"))}))))},D=(n(18),function(e){var t=e.data,n=e.dispatch,a=e.children;return r.a.createElement("div",{className:t.inDropZone?"drag-drop-zone inside-drag-area":"drag-drop-zone",onDrop:function(e){return function(e){e.preventDefault(),e.stopPropagation();var t,a=Object(p.a)(e.dataTransfer.files)[0],r=new FileReader;l(d,a)&&((t=new FileReader).onloadend=function(){var e=JSON.parse(t.result).galleryImages;n({type:"ADD_JSON_TO_LIST",files:e})},t.readAsText(a));if(l(s,a)){var i=new Image;r.readAsDataURL(a),r.onload=function(){i.src=r.result;i.onload=function(){var e=i.src,t=i.width,a=i.height;n({type:"ADD_FILE_TO_LIST",file:{url:e,width:t,height:a,ratio:t/a}})}}}r.onabort=function(){alert("Reading aborted")},r.onerror=function(){alert("Reading error")},e.dataTransfer.clearData(),n({type:"SET_DROP_DEPTH",dropDepth:0}),n({type:"SET_IN_DROP_ZONE",inDropZone:!1})}(e)},onDragOver:function(e){return function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy",n({type:"SET_IN_DROP_ZONE",inDropZone:!0})}(e)},onDragEnter:function(e){return function(e){e.preventDefault(),e.stopPropagation(),n({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth+1})}(e)},onDragLeave:function(e){return function(e){e.preventDefault(),e.stopPropagation(),n({type:"SET_DROP_DEPTH",dropDepth:t.dropDepth-1}),t.dropDepth>0||n({type:"SET_IN_DROP_ZONE",inDropZone:!1})}(e)}},r.a.createElement("div",{className:"drag-drop-zone-label"},"Drag and drop file (image or json) to upload"),a)}),b=function(e,t){switch(t.type){case"SET_DROP_DEPTH":return Object(h.a)(Object(h.a)({},e),{},{dropDepth:t.dropDepth});case"SET_IN_DROP_ZONE":return Object(h.a)(Object(h.a)({},e),{},{inDropZone:t.inDropZone});case"ADD_FILE_TO_LIST":return Object(h.a)(Object(h.a)({},e),{},{fileList:[].concat(Object(p.a)(e.fileList),[t.file])});case"ADD_JSON_TO_LIST":var n=t.files.map((function(e){return Object(h.a)(Object(h.a)({},e),{},{ratio:e.width/e.height})}));return Object(h.a)(Object(h.a)({},e),{},{fileList:[].concat(Object(p.a)(e.fileList),Object(p.a)(n))});case"REMOVE_IMAGE":return Object(h.a)(Object(h.a)({},e),{},{fileList:Object(p.a)(e.fileList.filter((function(e,n){return n!==t.index})))});default:return e}};n(19);var j=function(){var e=r.a.useReducer(b,{dropDepth:0,inDropZone:!1,fileList:[]}),t=Object(o.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"container full-height"},r.a.createElement(f,{dispatch:a}),r.a.createElement(D,{data:n,dispatch:a},r.a.createElement(g,{storeImages:n.fileList,dispatch:a}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[8,1,2]]]);
//# sourceMappingURL=main.a73189ee.chunk.js.map